{"version":3,"file":"index.umd.js","sources":["../node_modules/preact-habitat/dist/preact-habitat.es.js","../src/component.js","../src/index.js"],"sourcesContent":["import { h, render } from 'preact';\n\n/**\n * Removes `-` fron a string and capetalize the letter after\n * example: data-props-hello-world =>  dataPropsHelloWorld\n * Used for props passed from host DOM element\n * @param  {String} str string\n * @return {String} Capetalized string\n */\nvar camelcasize = function (str) {\n  return str.replace(/-([a-z])/gi, function (all, letter) {\n    return letter.toUpperCase();\n  });\n};\n\n/**\n * [getExecutedScript internal widget to provide the currently executed script]\n * @param  {document} document [Browser document object]\n * @return {HTMLElement}     [script Element]\n */\nvar getExecutedScript = function () {\n  return (\n    document.currentScript ||\n    (function () {\n      var scripts = document.getElementsByTagName(\"script\");\n      return scripts[scripts.length - 1];\n    })()\n  );\n};\n\n/**\n * Get the props from a host element's data attributes\n * @param  {Element} tag The host element\n * @return {Object}  props object to be passed to the component\n */\nvar collectPropsFromElement = function (element, defaultProps) {\n  if ( defaultProps === void 0 ) defaultProps = {};\n\n  var attrs = element.attributes;\n\n  var props = Object.assign({}, defaultProps);\n\n  // collect from element\n  Object.keys(attrs).forEach(function (key) {\n    if (attrs.hasOwnProperty(key)) {\n      var dataAttrName = attrs[key].name;\n      if (!dataAttrName || typeof dataAttrName !== \"string\") {\n        return false;\n      }\n      var propName = dataAttrName.split(/(data-props?-)/).pop() || '';\n      propName = camelcasize(propName);\n      if (dataAttrName !== propName) {\n        var propValue = attrs[key].nodeValue;\n        props[propName] = propValue;\n      }\n    }\n  });\n\n  // check for child script text/props or application/json\n  [].forEach.call(element.getElementsByTagName('script'), function (scrp) {\n    var propsObj = {};\n    if(scrp.hasAttribute('type')) {\n      if (\n        scrp.getAttribute(\"type\") !== \"text/props\" &&\n        scrp.getAttribute(\"type\") !== \"application/json\"\n      )\n        { return; }\n      try {\n        propsObj = JSON.parse(scrp.innerHTML);\n      } catch(e) {\n        throw new Error(e)\n      }\n      Object.assign(props, propsObj);\n    }\n  });  \n\n  return props;\n};\n\nvar getHabitatSelectorFromClient = function (currentScript) {\n  var scriptTagAttrs = currentScript.attributes;\n  var selector = null;\n  // check for another props attached to the tag\n  Object.keys(scriptTagAttrs).forEach(function (key) {\n    if (scriptTagAttrs.hasOwnProperty(key)) {\n      var dataAttrName = scriptTagAttrs[key].name;\n      if (dataAttrName === 'data-mount-in') {\n        selector = scriptTagAttrs[key].nodeValue;\n      }\n    }\n  });\n  return selector\n};\n\n/**\n * Return array of 0 or more elements that will host our widget\n * @param  {id} attrId the data widget id attribute the host should have\n * @param  {document} scope  Docuemnt object or DOM Element as a scope\n * @return {Array}        Array of matching habitats\n */\nvar widgetDOMHostElements = function (\n  ref\n) {\n  var selector = ref.selector;\n  var inline = ref.inline;\n  var clientSpecified = ref.clientSpecified;\n\n  var hostNodes = [];\n  var currentScript = getExecutedScript();\n\n  if (inline === true) {\n    var parentNode = currentScript.parentNode;\n    hostNodes.push(parentNode);\n  }\n  if (clientSpecified === true && !selector) {\n    // user did not specify where to mount - get it from script tag attributes\n    selector = getHabitatSelectorFromClient(currentScript);\n  }\n  if (selector) {\n    [].forEach.call(document.querySelectorAll(selector), function (queriedTag) {\n      hostNodes.push(queriedTag);\n    });\n  }\n  return hostNodes;\n};\n\n/**\n * preact render function that will be queued if the DOM is not ready\n * and executed immeidatly if DOM is ready\n */\nvar preactRender = function (widget, hostElements, root, cleanRoot, defaultProps) {\n  hostElements.forEach(function (elm) {\n    var hostNode = elm;\n    if (hostNode._habitat) {\n      return; \n    }\n    hostNode._habitat = true;\n    var props = collectPropsFromElement(elm, defaultProps) || defaultProps;\n    if(cleanRoot) {\n      hostNode.innerHTML = \"\";\n    }\n    return render(h(widget, props), hostNode, root);\n  });\n};\n\nvar habitat = function (Widget) {\n  // Widget represents the Preact component we need to mount\n  var widget = Widget;\n  // preact root render helper\n  var root = null;\n\n  var render$$1 = function (\n    ref\n  ) {\n    if ( ref === void 0 ) ref = {};\n    var selector = ref.selector; if ( selector === void 0 ) selector = null;\n    var inline = ref.inline; if ( inline === void 0 ) inline = false;\n    var clean = ref.clean; if ( clean === void 0 ) clean = false;\n    var clientSpecified = ref.clientSpecified; if ( clientSpecified === void 0 ) clientSpecified = false;\n    var defaultProps = ref.defaultProps; if ( defaultProps === void 0 ) defaultProps = {};\n\n    var elements = widgetDOMHostElements({\n      selector: selector,\n      inline: inline,\n      clientSpecified: clientSpecified\n    });\n    var loaded = function () {\n      if (elements.length > 0) {\n        var elements$1 = widgetDOMHostElements({\n          selector: selector,\n          inline: inline,\n          clientSpecified: clientSpecified\n        });\n\n        return preactRender(widget, elements$1, root, clean, defaultProps);\n      }\n    };\n    loaded();\n    document.addEventListener(\"DOMContentLoaded\", loaded);\n    document.addEventListener(\"load\", loaded);\n  };\n\n  return { render: render$$1 };\n};\n\nexport default habitat;\n//# sourceMappingURL=preact-habitat.es.js.map\n","import { h } from 'preact';\n\nimport \"./style.css\";\n\nexport default function App(props) {\n  return (\n    <div>\n      <h1 style={{ color: props.color }}>Hello, World!</h1>\n    </div>\n  );\n}\n","import habitat from \"preact-habitat\";\n\nimport Widget from \"./component\";\n\nlet _habitat = habitat(Widget);\n\n_habitat.render({\n  selector: '[data-widget-host=\"habitat\"]',\n  clean: true\n});\n"],"names":["widget","widgetDOMHostElements","ref","scripts","selector","inline","clientSpecified","hostNodes","currentScript","document","getElementsByTagName","length","push","parentNode","scriptTagAttrs","attributes","Object","keys","forEach","key","hasOwnProperty","name","nodeValue","getHabitatSelectorFromClient","call","querySelectorAll","queriedTag","props","h","style","color","render","clean","defaultProps","elements","loaded","elements$1","hostElements","root","cleanRoot","elm","hostNode","_habitat","element","attrs","assign","dataAttrName","propName","split","pop","replace","all","letter","toUpperCase","scrp","propsObj","hasAttribute","getAttribute","JSON","parse","innerHTML","e","Error","collectPropsFromElement","preactRender","addEventListener"],"mappings":"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"}